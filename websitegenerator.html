<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Memeportal — Website Generator</title>
<link rel="stylesheet" href="style.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
  <!-- Header (loaded from nav.html) -->
  <div id="site-header"></div>
  <script>
    // load nav + wire burger/dropdown safely
    (async function(){
      try{
        const host = document.getElementById('site-header');
        host.innerHTML = await (await fetch('nav.html')).text();

        const btn  = host.querySelector('.menu-toggle');
        const menu = host.querySelector('#mobileMenu');
        if(!btn || !menu) return;

        const close=()=>{menu.setAttribute('hidden','');btn.setAttribute('aria-expanded','false');document.removeEventListener('click',away);};
        const open =()=>{menu.removeAttribute('hidden');btn.setAttribute('aria-expanded','true');setTimeout(()=>document.addEventListener('click',away),0);};
        const away = e => { if(!menu.contains(e.target)&&!btn.contains(e.target)) close(); };

        btn.addEventListener('click',e=>{e.stopPropagation();menu.hasAttribute('hidden')?open():close();});
        window.matchMedia('(min-width:900px)').addEventListener?.('change',e=>{ if(e.matches) close(); });
        close();
      }catch(e){ console.warn('nav load failed', e); }
    })();
  </script>

  <div class="app app--wide">
    <aside>
      <!-- Sticky quick nav (auto built) -->
      <nav class="toc" id="wgToc">
        <div class="title">Quick menu</div>
        <div class="row" id="wgTocLinks"></div>
      </nav>

      <!-- BASICS -->
      <div class="card section" id="sec-basics">
        <h2>Project Basics</h2>
        <div class="grid">
          <div>
            <label>Project / Token name</label>
            <input id="p_name" type="text" placeholder="e.g. BeastLab" value="BeastLab">
          </div>
          <div class="grid two">
            <div>
              <label>Ticker</label>
              <input id="p_ticker" type="text" placeholder="e.g. BG" value="BG">
            </div>
            <div>
              <label>Chain</label>
              <select id="p_chain">
                <option>Solana</option><option>Ethereum</option><option>BNB Chain</option><option>Base</option><option>Polygon</option>
              </select>
            </div>
          </div>
          <div>
            <label>Contract address (CA)</label>
            <input id="p_ca" type="text" placeholder="Paste contract address">
          </div>
          <div>
            <label>Tagline</label>
            <input id="p_tag" type="text" placeholder="One-liner that sells the vibe" value="Meme tech from the jungle.">
          </div>

          <div class="grid three">
            <div>
              <label>Primary color</label>
              <input id="c_accent" type="color" value="#7c3aed">
            </div>
            <div>
              <label>Secondary color</label>
              <input id="c_accent2" type="color" value="#22d3ee">
            </div>
            <div>
              <label>Tertiary color</label>
              <input id="c_accent3" type="color" value="#3b82f6">
            </div>
          </div>

          <div class="grid two">
            <div>
              <label>Style preset</label>
              <select id="style_preset">
                <option value="serious" selected>Serious — clean</option>
                <option value="cartoony">Cartoony — comic / halftone</option>
                <option value="neon">Neon — synthwave glow</option>
                <option value="glass">Glass — frosted panels</option>
                <option value="retro">Retro Terminal — CRT</option>
                <option value="zine">Paper Zine — torn cutout</option>
              </select>
            </div>
            <div>
              <label>Card radius</label>
              <input id="c_radius" type="range" min="6" max="28" value="18">
            </div>
          </div>

          <div>
            <label>Background style</label>
            <select id="c_bg">
              <option value="memeportal" selected>Memeportal gradient</option>
              <option value="dark">Dark solid</option>
              <option value="radial">Radial glow</option>
            </select>
          </div>
        </div>
      </div>

      <!-- MEDIA -->
      <div class="card section" id="sec-media">
        <h2>Media</h2>
        <div class="grid">
          <div class="drop" id="logoDrop">
            <input id="logoFile" type="file" accept="image/*">
            <div><strong>Logo</strong> PNG/SVG — transparent preferred. <button class="btn ghost" id="logoBrowse">Browse</button></div>
          </div>
          <div class="drop" id="bannerDrop">
            <input id="bannerFile" type="file" accept="image/*">
            <div><strong>Banner</strong> wide PNG/JPG/WebP (auto‑fit). <button class="btn ghost" id="bannerBrowse">Browse</button></div>
          </div>
        </div>
      </div>

      <!-- LINKS -->
      <div class="card section" id="sec-links">
        <h2>Links</h2>
        <div class="grid">
          <div><label>Website</label><input id="l_site" type="text" placeholder="https://"></div>
          <div class="grid two">
            <div><label>Twitter/X</label><input id="l_x" type="text" placeholder="https://x.com/..."></div>
            <div><label>Telegram</label><input id="l_tg" type="text" placeholder="https://t.me/..."></div>
          </div>
          <div class="grid two">
            <div><label>DexScreener</label><input id="l_ds" type="text" placeholder="https://dexscreener.com/..."></div>
            <div><label>Whitepaper</label><input id="l_wp" type="text" placeholder="https://...pdf"></div>
          </div>
        </div>
      </div>

      <!-- SECTIONS -->
      <div class="card section" id="sec-sections">
        <h2>Sections</h2>
        <div class="grid">
          <div class="flex">
            <input id="s_about_e" type="checkbox" checked><label for="s_about_e" style="margin:0">About / Info</label>
          </div>
          <textarea id="s_about" rows="3">BeastLab is a memecoin with utility—clean branding, fair launch, and a community that ships.</textarea>

          <div class="flex">
            <input id="s_token_e" type="checkbox" checked><label for="s_token_e" style="margin:0">Tokenomics</label>
          </div>
          <div class="grid two">
            <div><label>Supply</label><input id="tok_supply" type="text" value="1,000,000,000"></div>
            <div><label>Decimals</label><input id="tok_dec" type="number" value="9"></div>
            <div><label>Buy Tax %</label><input id="tok_buy" type="number" value="0"></div>
            <div><label>Sell Tax %</label><input id="tok_sell" type="number" value="0"></div>
          </div>
          <details>
            <summary class="small">Allocations (optional)</summary>
            <textarea id="tok_alloc" class="tiny" rows="3">Liquidity:70, Community:20, Treasury:10</textarea>
          </details>

          <div class="flex" style="margin-top:6px">
            <input id="s_road_e" type="checkbox" checked><label for="s_road_e" style="margin:0">Roadmap</label>
          </div>
          <textarea id="s_road" rows="3">Phase 1 — Launch, socials, CMC/CG listing
Phase 2 — Partnerships, Meme contest, CEX listing
Phase 3 — Utilities drop, DAO experiments</textarea>

          <div class="flex">
            <input id="s_team_e" type="checkbox"><label for="s_team_e" style="margin:0">Team (optional)</label>
          </div>
          <textarea id="s_team" rows="2" placeholder="Each line Name — Role"></textarea>

          <div class="flex">
            <input id="s_disclaimer_e" type="checkbox" checked><label for="s_disclaimer_e" style="margin:0">Disclaimer</label>
          </div>
          <textarea id="s_disclaimer" rows="2">This is not financial advice. Cryptocurrency involves risk. Do your own research.</textarea>
        </div>
      </div>

      <!-- ORDER / LAYOUT -->
      <div class="card section" id="sec-order">
        <h2>Order & layout</h2>
        <div id="orderList" class="list" style="user-select:none"></div>
        <div class="tiny muted" style="margin-top:6px">Use ↑ / ↓ to reorder the enabled sections.</div>
      </div>

      <!-- ADVANCED -->
      <div class="card section" id="sec-advanced">
        <h2>Advanced</h2>
        <details open>
          <summary class="small">More control</summary>
          <div class="grid" style="margin-top:10px">
            <div class="grid two">
              <div>
                <label>Heading font</label>
                <select id="adv_font_title">
                  <option value="Inter">Inter</option>
                  <option value="Impact">Impact</option>
                  <option value="Archivo Black">Archivo Black</option>
                  <option value="Space Grotesk">Space Grotesk</option>
                </select>
              </div>
              <div>
                <label>Body font</label>
                <select id="adv_font_body">
                  <option value="Inter" selected>Inter</option>
                  <option value="Space Grotesk">Space Grotesk</option>
                  <option value="IBM Plex Sans">IBM Plex Sans</option>
                  <option value="Atkinson Hyperlegible">Atkinson Hyperlegible</option>
                </select>
              </div>
            </div>

            <div class="grid two">
              <div>
                <label>Shadow strength</label>
                <input id="adv_shadow" type="range" min="0" max="1" step="0.05" value="0.35">
              </div>
              <div>
                <label>Gradient intensity</label>
                <input id="adv_grad" type="range" min="0" max="1" step="0.05" value="0.10">
              </div>
            </div>

            <div class="grid two">
              <div class="flex">
                <input id="adv_noise" type="checkbox">
                <label for="adv_noise" style="margin:0">Subtle noise overlay</label>
              </div>
              <div class="flex">
                <input id="adv_hero_flip" type="checkbox">
                <label for="adv_hero_flip" style="margin:0">Flip hero layout</label>
              </div>
            </div>

            <div class="grid two">
              <div>
                <label>Border style</label>
                <select id="adv_border">
                  <option value="soft" selected>Soft</option>
                  <option value="hard">Hard / solid</option>
                  <option value="dashed">Dashed</option>
                </select>
              </div>
              <div>
                <label>Button shape</label>
                <select id="adv_button">
                  <option value="rounded" selected>Rounded</option>
                  <option value="pill">Pill</option>
                  <option value="square">Square</option>
                </select>
              </div>
            </div>

            <div>
              <label>Max container width</label>
              <input id="adv_width" type="range" min="900" max="1400" step="10" value="1140">
            </div>
          </div>
        </details>
      </div>

      <!-- ACTIONS -->
      <div class="card section" id="sec-actions">
        <h2>Actions</h2>
        <div class="toolbar right">
          <button class="btn primary" id="refreshBtn">Update Preview</button>
          <button class="btn success" id="exportZip">Download ZIP</button>
        </div>
        <div class="footer">ZIP includes <strong>index.html</strong> and an <strong>assets/</strong> folder with your images.</div>
      </div>
    </aside>

    <main>
      <div class="card section preview-pane">
        <div class="kicker">Preview</div>
        <div id="preview" class="preview-frame"></div>
      </div>
    </main>
  </div>

<!-- ================== SCRIPT ================== -->
<script>
(function(){
  const state = { logo:null, banner:null, logoUrl:'', bannerUrl:'', order:['about','token','road','team'] };
  const el = id => document.getElementById(id);

  // sticky quick-nav auto build
  (function buildToc(){
    const tocWrap = document.getElementById('wgTocLinks');
    const secs = Array.from(document.querySelectorAll('aside .section[id]'));
    tocWrap.innerHTML = secs.map(s=>`<a href="#${s.id}">${s.querySelector('h2')?.textContent || s.id}</a>`).join('');
    const links = Array.from(tocWrap.querySelectorAll('a'));
    const linkFor = id => links.find(a => a.getAttribute('href') === '#'+id);
    const obs = new IntersectionObserver(entries=>{
      const a = entries.filter(e=>e.isIntersecting).sort((x,y)=>x.boundingClientRect.top - y.boundingClientRect.top)[0];
      if(!a) return; links.forEach(n=>n.classList.remove('active')); linkFor(a.target.id)?.classList.add('active');
    },{root:document.querySelector('aside'),threshold:.2});
    secs.forEach(s=>obs.observe(s));
  })();

  // controls
  const ids = [
    'p_name','p_ticker','p_chain','p_ca','p_tag',
    'style_preset','c_accent','c_accent2','c_accent3','c_bg','c_radius',
    'l_site','l_x','l_tg','l_ds','l_wp',
    's_about_e','s_about','s_token_e','tok_supply','tok_dec','tok_buy','tok_sell','tok_alloc',
    's_road_e','s_road','s_team_e','s_team','s_disclaimer_e','s_disclaimer',
    'adv_font_title','adv_font_body','adv_shadow','adv_grad','adv_noise','adv_hero_flip','adv_border','adv_button','adv_width'
  ];
  const inputs = ids.reduce((o,k)=> (o[k]=el(k),o), {});
  const preview = el('preview');
  const refreshBtn = el('refreshBtn');
  const exportBtn = el('exportZip');

  // media
  const logoFile = el('logoFile'), bannerFile = el('bannerFile');
  const logoBrowse=el('logoBrowse'), bannerBrowse=el('bannerBrowse');
  const logoDrop=el('logoDrop'), bannerDrop=el('bannerDrop');

  logoBrowse.addEventListener('click', ()=>logoFile.click());
  bannerBrowse.addEventListener('click', ()=>bannerFile.click());
  ['dragenter','dragover'].forEach(evt=>logoDrop.addEventListener(evt, e=>{e.preventDefault();logoDrop.classList.add('drag');}));
  ;['dragleave','drop'].forEach(evt=>logoDrop.addEventListener(evt, e=>{e.preventDefault();logoDrop.classList.remove('drag');}));
  logoDrop.addEventListener('drop', e=>{ const f=e.dataTransfer.files?.[0]; if(f){ setLogo(f); }});
  ['dragenter','dragover'].forEach(evt=>bannerDrop.addEventListener(evt, e=>{e.preventDefault();bannerDrop.classList.add('drag');}));
  ;['dragleave','drop'].forEach(evt=>bannerDrop.addEventListener(evt, e=>{e.preventDefault();bannerDrop.classList.remove('drag');}));
  bannerDrop.addEventListener('drop', e=>{ const f=e.dataTransfer.files?.[0]; if(f){ setBanner(f); }});
  logoFile.addEventListener('change', ()=>{ if(logoFile.files[0]) setLogo(logoFile.files[0]); });
  bannerFile.addEventListener('change', ()=>{ if(bannerFile.files[0]) setBanner(bannerFile.files[0]); });

  function setLogo(f){ state.logo=f; state.logoUrl=URL.createObjectURL(f); buildPreview(); }
  function setBanner(f){ state.banner=f; state.bannerUrl=URL.createObjectURL(f); buildPreview(); }

  /* ===== THEME ===== */
  function presetVars(type, vars){
    const base = {
      accent: vars.accent, accent2: vars.accent2, accent3: vars.accent3,
      bg: vars.bg, radius: vars.radius,
      fontTitle: `800 36px '${inputs.adv_font_title.value}', system-ui`,
      fontBody: `15px '${inputs.adv_font_body.value}', system-ui`,
      shadowAmt: +inputs.adv_shadow.value, gradAmt: +inputs.adv_grad.value,
      noise: inputs.adv_noise.checked, heroFlip: inputs.adv_hero_flip.checked,
      borderStyle: inputs.adv_border.value, buttonShape: inputs.adv_button.value,
      maxWidth: +inputs.adv_width.value
    };
    if(type==='serious')  return {...base, theme:'serious', decoration:'none'};
    if(type==='cartoony') return {...base, theme:'cartoony', decoration:'comic', fontTitle:`900 40px 'Impact', Haettenschweiler, 'Arial Black', sans-serif`};
    if(type==='neon')     return {...base, theme:'neon', decoration:'neon'};
    if(type==='glass')    return {...base, theme:'glass', decoration:'glass'};
    if(type==='retro')    return {...base, theme:'retro', decoration:'crt', accent:'#2bff88', accent2:'#57ffa1', fontBody:`14px 'IBM Plex Mono', ui-monospace, SFMono-Regular`};
    return {...base, theme:'zine', decoration:'zine', fontTitle:`900 36px 'Archivo Black', system-ui`};
  }

  function hex2rgba(hex,a){
    try{const h=hex.replace('#','');const b=parseInt(h.length===3?h.split('').map(c=>c+c).join(''):h,16);
      const r=(b>>16)&255,g=(b>>8)&255,bl=b&255; return `rgba(${r},${g},${bl},${a})`;
    }catch(e){return `rgba(59,130,246,${a})`;}
  }

  function commonCss(v){
    const border = v.borderStyle==='hard' ? '1px solid #3a4263' :
                   v.borderStyle==='dashed' ? '2px dashed #39405f' : '1px solid #22273a';
    const btnRadius = v.buttonShape==='pill' ? '999px' : v.buttonShape==='square' ? '8px' : '12px';
    const bgBase = v.bg==='memeportal'
      ? `radial-gradient(1200px 800px at 10% -10%, ${hex2rgba(v.accent2,.22*v.gradAmt)}, transparent),
         radial-gradient(900px 700px at 120% 10%, ${hex2rgba(v.accent,.22*v.gradAmt)}, transparent),
         radial-gradient(1200px 900px at 50% 120%, ${hex2rgba(v.accent3||'#3b82f6', .18+.3*v.gradAmt)}, transparent),
         #0f1115`
      : v.bg==='radial'
      ? `radial-gradient(900px 700px at 120% 10%, ${hex2rgba(v.accent,.45*v.gradAmt)}, transparent),
         radial-gradient(900px 700px at -20% 120%, ${hex2rgba(v.accent3||'#3b82f6', .35*v.gradAmt)}, transparent),
         #0e1016`
      : `#0e1016`;
    const shadow = `0 ${8+16*v.shadowAmt}px ${20+40*v.shadowAmt}px rgba(0,0,0, ${.25+.35*v.shadowAmt})`;
    const noise = v.noise ? `
      body::before{content:'';position:fixed;inset:0;pointer-events:none;background:
       url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity=".025"/></svg>') repeat}
    ` : '';
    return `
:root{--accent:${v.accent};--accent2:${v.accent2};--accent3:${v.accent3};--radius:${v.radius}px;--border:#22273a;--card:#10131c;--muted:#8892a6;--text:#e6e9ef}
*{box-sizing:border-box}
body{margin:0;color:var(--text);background:${bgBase};font:${v.fontBody}}
${noise}
.container{max-width:${v.maxWidth}px;margin:0 auto;padding:20px}
.card{background:var(--card);border:${border};border-radius:var(--radius);box-shadow:${shadow}}
.btn{display:inline-flex;align-items:center;gap:8px;border:1px solid #2b3352;background:#0f1424;color:#fff;padding:10px 14px;border-radius:${btnRadius};text-decoration:none;font-weight:800}
.btn:hover{border-color:#39436c}
.section{padding:16px}
.h2{font-size:12px;letter-spacing:.2em;text-transform:uppercase;color:#9aa6c6;margin:0 0 10px}
.list{display:grid;gap:10px}
.kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.kpi .item{padding:12px;border-radius:12px;border:1px solid var(--border);background:#0b0f17}
.kpi .item .t{font-size:12px;color:#9aa6c6}
.kpi .item .v{font-size:18px;font-weight:900;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;background-clip:text;color:transparent}
.tokenomics{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
.tokenomics .card{padding:14px}
.timeline{position:relative;padding-left:22px}
.timeline::before{content:'';position:absolute;left:10px;top:0;bottom:0;width:2px;background:linear-gradient(var(--accent),var(--accent2))}
.timeline .step{position:relative;margin:10px 0;padding:10px 12px;background:#0b0f17;border:1px solid var(--border);border-radius:12px}
.timeline .step::before{content:'';position:absolute;left:-6px;top:12px;width:10px;height:10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent2))}
.footer{display:flex;justify-content:space-between;align-items:center;padding:14px 0;color:#9aa6c6}
.header-logo{width:40px;height:40px;border-radius:10px;object-fit:contain;background:#0b0f17;border:1px solid var(--border);padding:4px}
.logo-fallback{width:40px;height:40px;border-radius:12px;background:conic-gradient(from 210deg,var(--accent),var(--accent2))}
a{color:#c8d2ff}
@media (max-width:900px){
  .split{grid-template-columns:1fr}
  .container{padding:14px}
  .kpi{grid-template-columns:repeat(2,1fr)}
}
@media (max-width:600px){ .kpi{grid-template-columns:1fr} }
img.banner{width:100%;height:clamp(220px,34vh,360px);object-fit:cover;display:block;border-radius:16px;border:1px solid var(--border)}
`; }

  function themeCss(v){
    if(v.theme==='cartoony'){ return `
body{background:#131525}
.card{border:4px solid #1a1846}
.comic-hero{position:relative;overflow:hidden;border-radius:18px;background:
  radial-gradient(80% 100% at 20% -10%, ${v.accent}22 0, transparent 60%),
  radial-gradient(80% 100% at 120% 10%, ${v.accent2}22 0, transparent 60%), #0f1022}
.comic-topper{height:12px;background:repeating-linear-gradient(45deg,#0000 0 4px,#341b7a 4px 8px,#0000 8px 12px)}
.comic-title{-webkit-text-stroke:3px #341b7a;color:#fff;letter-spacing:.5px}
.speech{background:#fff;color:#111;border-radius:16px 16px 16px 2px;padding:10px 14px;border:3px solid #111;box-shadow:6px 6px 0 #0007}
.halftone{background-image:radial-gradient(#ffffff33 1px, transparent 1px);background-size:6px 6px;mix-blend-mode:overlay;position:absolute;inset:0;pointer-events:none}
.split{display:grid;grid-template-columns:1.4fr .8fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
.zigzag{height:12px;background:
 linear-gradient(135deg,transparent 8px,#1a1846 0) left,
 linear-gradient(-135deg,transparent 8px,#1a1846 0) right;
 background-size:16px 100%; background-repeat:no-repeat}
img.banner{height:280px;border:5px solid #1a1846;border-radius:14px}
.tokenomics .card{border:3px solid #111;background:#fff;color:#111;box-shadow:6px 6px 0 #0007}
.timeline .step{border:3px solid #1a1846;background:#0e1130;color:#dbe0ff}
`; }
    if(v.theme==='neon'){ return `
body{background:#05060c}
.grid-bg{position:absolute;inset:0;background:
  linear-gradient(transparent 0 60%, ${v.accent}11 60% 61%,transparent 61%),
  linear-gradient(90deg,transparent 0 60%, ${v.accent2}11 60% 61%,transparent 61%);background-size:40px 40px;filter:blur(.3px)}
.neon-hero{position:relative;border-radius:20px;background:#0a0b18;border:1px solid #20254a;box-shadow:0 0 40px ${v.accent}33 inset, 0 0 60px ${v.accent2}22}
.neon-title{font-weight:900;letter-spacing:.5px;text-shadow:0 0 10px ${v.accent}, 0 0 24px ${v.accent2}}
.neon-chip{border:1px solid #2a3263;border-radius:999px;padding:6px 10px;background:#0c1227}
.btn{box-shadow:0 0 12px ${v.accent}55 inset, 0 0 18px ${v.accent2}44}
img.banner{border-radius:18px;border:1px solid #2a3263}
.split{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
.tokenomics .card{background:#0b0f1f;border:1px solid #2a3263;box-shadow:0 0 24px ${v.accent2}22 inset}
.timeline .step{background:#0b0f1f;border:1px solid #2a3263}
`; }
    if(v.theme==='glass'){ return `
body{background:radial-gradient(1200px 800px at 10% -10%, ${v.accent2}11, transparent),radial-gradient(1200px 800px at 120% 10%, ${v.accent}11, transparent), #0a0c12}
.card{background:rgba(16,19,28,.55);backdrop-filter:saturate(1.2) blur(12px);border:1px solid #2a314d}
.glass-hero{position:relative;border-radius:20px;background:linear-gradient(180deg,#0b1020aa,#0c1022aa)}
img.banner{border-radius:20px;filter:saturate(1.1) contrast(1.05)}
.split{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
.tokenomics .card{background:rgba(12,16,28,.6);backdrop-filter:blur(6px);border:1px solid #2a314d}
.timeline .step{background:rgba(12,16,28,.6);backdrop-filter:blur(4px);border:1px solid #2a314d}
`; }
    if(v.theme==='retro'){ return `
body{color:#caffd7;background:#03130a}
.container{filter:contrast(1.1)}
.card{background:#06180c;border:1px solid #123a23}
.crt-scan::after{content:'';position:fixed;inset:0;pointer-events:none;background:repeating-linear-gradient(0deg, rgba(0,0,0,.14), rgba(0,0,0,.14) 1px, transparent 1px, transparent 3px)}
.mono{font-family:'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}
.btn{border-color:#1f6a3c;background:#052313}
img.banner{border:1px solid #1f6a3c;border-radius:10px}
.split{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
.tokenomics .card{background:#03160a;border:1px solid #1f6a3c}
.timeline .step{background:#03160a;border:1px solid #1f6a3c}
`; }
    if(v.theme==='zine'){ return `
body{background:#0e0f14}
.card{background:#0c0f17;border:2px solid #0a0c14;box-shadow:8px 8px 0 #00000055}
.torn{position:relative}
.torn:before{content:'';position:absolute;inset:-14px -14px auto -14px;height:28px;
  background:linear-gradient(-45deg, #fff 12px, transparent 12px) 0 0/28px 28px,
             linear-gradient(45deg,  #fff 12px, transparent 12px) 0 0/28px 28px;
  mix-blend-mode:overlay;opacity:.06}
.tape{position:absolute;width:110px;height:28px;background:#e9e9d9aa;top:-10px;left:16px;transform:rotate(-6deg)}
img.banner{border:4px solid #000;border-radius:6px;filter:grayscale(.1) contrast(1.05)}
.split{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
.stamp{display:inline-block;border:3px dashed #fff3;padding:6px 10px;transform:rotate(-3deg)}
.tokenomics .card{border:3px dashed #fff3;background:#0a0d16}
.timeline .step{border:3px dashed #fff3;background:#0a0d16}
`; }
    return `
.hero{position:relative;overflow:hidden;border-radius:calc(var(--radius) + 6px)}
.hero .inner{display:grid;grid-template-columns:420px 1fr;gap:24px;align-items:center;padding:28px}
@media (max-width:900px){.hero .inner{grid-template-columns:1fr;padding:20px}}
.hero .badge{display:inline-block;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;background-clip:text;color:transparent;font-weight:900}
.hero h1{font:${v.fontTitle};margin:6px 0 4px}
.hero p{color:var(--muted);margin:0 0 12px}
.hero .cta{display:flex;gap:10px;flex-wrap:wrap}
.hero .gfx{position:absolute;inset:auto -80px -80px auto;opacity:.6;filter:blur(40px);pointer-events:none}
.split{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:900px){.split{grid-template-columns:1fr}}
`; }

  function siteCss(v){ return commonCss(v) + themeCss(v); }

  /* HERO builders (same as previous messages) */
  function heroSerious(d,v){return `
<section class="hero card section" style="margin-top:14px">
  <div class="inner">
    <div>
      <div class="badge">${esc(d.ticker)} / ${esc(d.chain)}</div>
      <h1>${esc(d.name)}</h1>
      <p>${esc(d.tagline)}</p>
      ${d.ca? `<div class="kpi" style="grid-template-columns:1fr"><div class="item"><div class="t">CA</div><div class="v" style="word-break:break-all">${esc(d.ca)}</div></div></div>`:''}
      <div class="cta" style="margin-top:10px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">Website</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">Twitter/X</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">Whitepaper</a>`:''}
      </div>
    </div>
    <div style="justify-self:end;align-self:center">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" alt="Logo" style="width:180px;height:180px;object-fit:contain;border-radius:18px;border:1px solid var(--border);background:#0b0f17;padding:12px">`:
        `<div style="width:180px;height:180px;border-radius:18px;border:1px dashed var(--border);display:grid;place-items:center;color:#9aa6c6">Logo</div>`}
    </div>
  </div>
</section>`;}
  function heroCartoony(d,v){return `
<section class="comic-hero card torn" style="margin-top:14px">
  <div class="comic-topper"></div>
  <div style="display:grid;grid-template-columns:${v.heroFlip?'1fr 360px':'360px 1fr'};gap:22px;align-items:center;padding:22px 22px 12px">
    <div style="${v.heroFlip?'order:2':''}">
      <div class="speech"><b>${esc(d.ticker)}</b> on <b>${esc(d.chain)}</b> — let's go!</div>
      <h1 class="comic-title" style="margin:12px 0 6px">${esc(d.name)}</h1>
      <p style="color:#cdd2ff">${esc(d.tagline)}</p>
      ${d.ca? `<div class="stamp" style="margin:10px 0; color:#fff">${esc(d.ca).slice(0,10)}…</div>`:''}
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">Website</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">Twitter/X</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">Whitepaper</a>`:''}
      </div>
    </div>
    <div style="justify-self:end">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" class="sticker" alt="Logo" style="width:220px;height:220px;object-fit:contain;background:#fff;border-radius:14px;padding:12px">`:
      `<div class="sticker" style="width:220px;height:220px;border-radius:14px;display:grid;place-items:center;background:#fff;color:#111">Logo</div>`}
    </div>
  </div>
  <div class="halftone"></div>
  <div class="zigzag"></div>
</section>`;}
  function heroNeon(d,v){return `
<section class="neon-hero card" style="margin-top:14px;position:relative;overflow:hidden">
  <div class="grid-bg"></div>
  <div style="display:grid;grid-template-columns:${v.heroFlip?'1fr 380px':'380px 1fr'};gap:24px;align-items:center;padding:26px;position:relative">
    <div style="${v.heroFlip?'order:2':''}">
      <div class="neon-chip">${esc(d.ticker)} / ${esc(d.chain)}</div>
      <h1 class="neon-title" style="margin:8px 0 6px">${esc(d.name)}</h1>
      <p style="color:#a8b2ff">${esc(d.tagline)}</p>
      ${d.ca? `<div class="kpi" style="grid-template-columns:1fr"><div class="item"><div class="t">CA</div><div class="v" style="word-break:break-all">${esc(d.ca)}</div></div></div>`:''}
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">Website</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">Twitter/X</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">Whitepaper</a>`:''}
      </div>
    </div>
    <div style="justify-self:end">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" alt="Logo" style="width:220px;height:220px;object-fit:contain;border-radius:18px;border:1px solid #2a3263;background:#0b0f17;padding:14px;box-shadow:0 0 30px ${v.accent2}66">`:
      `<div style="width:220px;height:220px;border-radius:18px;border:1px dashed #2a3263;display:grid;place-items:center;color:#9aa6c6">Logo</div>`}
    </div>
  </div>
</section>`;}
  function heroGlass(d,v){return `
<section class="glass-hero card" style="margin-top:14px">
  <div style="display:grid;grid-template-columns:${v.heroFlip?'1fr 360px':'360px 1fr'};gap:22px;align-items:center;padding:24px">
    <div style="${v.heroFlip?'order:2':''}">
      <div class="h2" style="margin:0">${esc(d.ticker)} on ${esc(d.chain)}</div>
      <h1 style="font:${v.fontTitle};margin:6px 0 6px">${esc(d.name)}</h1>
      <p style="color:#c7d1ff">${esc(d.tagline)}</p>
      ${d.ca? `<div class="kpi" style="grid-template-columns:1fr"><div class="item"><div class="t">CA</div><div class="v" style="word-break:break-all">${esc(d.ca)}</div></div></div>`:''}
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">Website</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">Twitter/X</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">Whitepaper</a>`:''}
      </div>
    </div>
    <div style="justify-self:end">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" alt="Logo" style="width:200px;height:200px;object-fit:contain;border-radius:22px;border:1px solid #2a314d;background:#0b0f17aa;padding:16px;backdrop-filter:blur(6px)">`:
      `<div style="width:200px;height:200px;border-radius:22px;border:1px dashed #2a314d;display:grid;place-items:center;color:#9aa6c6">Logo</div>`}
    </div>
  </div>
</section>`;}
  function heroRetro(d,v){return `
<section class="card mono crt-scan" style="margin-top:14px">
  <div style="display:grid;grid-template-columns:${v.heroFlip?'1fr 360px':'360px 1fr'};gap:20px;align-items:center;padding:18px">
    <div style="${v.heroFlip?'order:2':''}">
      <div class="h2 mono" style="margin:0">:: ${esc(d.ticker)} @ ${esc(d.chain)}</div>
      <h1 class="mono" style="font-weight:900;margin:6px 0 4px">${esc(d.name)}</h1>
      <p class="mono" style="color:#86ffbd">${esc(d.tagline)}</p>
      ${d.ca? `<pre class="mono" style="white-space:pre-wrap;word-break:break-all;background:#03160a;padding:8px;border:1px solid #144e2b;border-radius:8px">CA ${esc(d.ca)}</pre>`:''}
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">open(site)</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">open(x)</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">open(whitepaper)</a>`:''}
      </div>
    </div>
    <div style="justify-self:end">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" alt="Logo" style="width:200px;height:200px;object-fit:contain;border-radius:10px;border:1px solid #1f6a3c;background:#03160a;padding:10px">`:
      `<div style="width:200px;height:200px;border-radius:10px;border:1px dashed #1f6a3c;display:grid;place-items:center;color:#86ffbd" class="mono">Logo</div>`}
    </div>
  </div>
</section>`;}
  function heroZine(d,v){return `
<section class="card torn" style="margin-top:14px;position:relative">
  <div class="tape"></div>
  <div style="display:grid;grid-template-columns:${v.heroFlip?'1fr 320px':'320px 1fr'};gap:18px;align-items:center;padding:18px">
    <div style="${v.heroFlip?'order:2':''}">
      <div class="stamp" style="color:#fff">${esc(d.ticker)} / ${esc(d.chain)}</div>
      <h1 class="title-outline" style="margin:10px 0 6px">${esc(d.name)}</h1>
      <p style="color:#c7d1ff">${esc(d.tagline)}</p>
      ${d.ca? `<div class="stamp" style="margin:8px 0;color:#fff">${esc(d.ca).slice(0,14)}…</div>`:''}
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        ${d.links.site? `<a class="btn" href="${esc(d.links.site)}">Website</a>`:''}
        ${d.links.x? `<a class="btn" href="${esc(d.links.x)}">Twitter/X</a>`:''}
        ${d.links.wp? `<a class="btn" href="${esc(d.links.wp)}">Whitepaper</a>`:''}
      </div>
    </div>
    <div style="justify-self:end">
      ${d.logoSrc? `<img src="${esc(d.logoSrc)}" class="sticker" alt="Logo" style="width:200px;height:200px;object-fit:contain;background:#fff;border-radius:8px;padding:12px">`:
      `<div class="sticker" style="width:200px;height:200px;border-radius:8px;display:grid;place-items:center;background:#fff;color:#111">Logo</div>`}
    </div>
  </div>
</section>`;}

  function sectionsHtml(d,v){
    const about = d.aboutEnabled? `
      <div class="${v.theme==='zine'?'card torn':'card'} section">
        <div class="h2">${v.theme==='retro'?'ABOUT::':'About'}</div>
        <div>${nl2br(esc(d.about))}</div>
      </div>`:'';
    const token = d.tokenEnabled? `
      <div class="${v.theme==='zine'?'card torn':'card'} section">
        <div class="h2">${v.theme==='retro'?'TOKENOMICS::':'Tokenomics'}</div>
        <div class="tokenomics">
          <div class="card"><div class="t">Supply</div><div class="v">${esc(d.supply)}</div></div>
          <div class="card"><div class="t">Decimals</div><div class="v">${esc(d.dec)}</div></div>
          <div class="card"><div class="t">Buy Tax</div><div class="v">${esc(d.buy)}%</div></div>
          <div class="card"><div class="t">Sell Tax</div><div class="v">${esc(d.sell)}%</div></div>
          ${parseAllocations(d.tokAlloc).map(a=>`<div class="card"><div class="t">${esc(a.k)}</div><div class="v">${esc(a.v)}%</div></div>`).join('')}
        </div>
      </div>`:'';
    const road = d.roadEnabled? `
    <section class="${v.theme==='zine'?'card torn':'card'} section" style="margin-top:14px">
      <div class="h2">${v.theme==='retro'?'ROADMAP::':'Roadmap'}</div>
      <div class="timeline">${(d.road||'').split('\n').filter(Boolean).map(l=>`<div class="step">${esc(l)}</div>`).join('')}</div>
    </section>`:'';
    const team = d.teamEnabled? `
    <section class="${v.theme==='zine'?'card torn':'card'} section" style="margin-top:14px">
      <div class="h2">${v.theme==='retro'?'TEAM::':'Team'}</div>
      <ul class="list">${(d.team||'').split('\n').filter(Boolean).map(l=>`<li>${esc(l)}</li>`).join('')}</ul>
    </section>`:'';
    return {about, token, road, team};
  }

  function siteHtml(data){
    const v = data.vars;
    const banner = data.bannerSrc? `<img src="${esc(data.bannerSrc)}" class="banner" alt="Banner">` : '';
    const head = `
<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>${esc(data.name)} — ${esc(data.ticker)}</title>
<style>${siteCss(v)}</style>
</head><body class="${v.decoration==='crt'?'crt':''}">`;

    const headerLogo = data.logoSrc
      ? `<img src="${esc(data.logoSrc)}" alt="Logo" class="header-logo">`
      : `<div class="logo-fallback" aria-hidden="true"></div>`;

    const header = `
  <div class="container">
    <header class="section" style="display:flex;justify-content:space-between;align-items:center;gap:10px">
      <div style="display:flex;align-items:center;gap:12px">
        ${headerLogo}
        <div>
          <div class="h2" style="margin:0">${esc(data.ticker)} on ${esc(data.chain)}</div>
          <div style="font-weight:900;font-size:18px">${esc(data.name)}</div>
        </div>
      </div>
      <div class="kpi" style="grid-template-columns:repeat(2,auto);gap:8px">
        ${data.links.ds?`<a class="btn" href="${esc(data.links.ds)}">DexScreener</a>`:''}
        ${data.links.tg?`<a class="btn" href="${esc(data.links.tg)}">Telegram</a>`:''}
      </div>
    </header>
    ${banner}
`;

    const hero = v.theme==='cartoony' ? heroCartoony(data,v)
               : v.theme==='neon'     ? heroNeon(data,v)
               : v.theme==='glass'    ? heroGlass(data,v)
               : v.theme==='retro'    ? heroRetro(data,v)
               : v.theme==='zine'     ? heroZine(data,v)
               : heroSerious(data,v);

    const {about, token, road, team} = sectionsHtml(data,v);
    const sectionMap = {about, token, road, team};
    const ordered = state.order.map(k=>sectionMap[k]).filter(Boolean).join('');

    const foot = data.disclaimerEnabled? `
    <footer class="footer">
      <div>© ${new Date().getFullYear()} ${esc(data.name)} — ${esc(data.ticker)}</div>
      <div>${esc(data.disclaimer)}</div>
    </footer>` : '';

    return head + header + hero + '\n' + ordered + foot + '\n  </div>\n</body></html>';
  }

  /* helpers */
  const esc = s => String(s||'').replace(/[&<>"]/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
  const nl2br = s => s.replace(/\n/g,'<br>');
  function parseAllocations(str){
    return (str||'').split(',').map(s=>s.trim()).filter(Boolean).map(s=>{
      const m=s.split(':'); return {k:(m[0]||'').trim(), v:(m[1]||'').trim()};
    }).filter(x=>x.k && x.v);
  }

  function collect(){
    const vars = presetVars(inputs.style_preset.value, {
      accent: inputs.c_accent.value,
      accent2: inputs.c_accent2.value,
      accent3: inputs.c_accent3.value,
      bg: inputs.c_bg.value,
      radius: +inputs.c_radius.value
    });

    return {
      name: inputs.p_name.value.trim(),
      ticker: inputs.p_ticker.value.trim(),
      chain: inputs.p_chain.value,
      ca: inputs.p_ca.value.trim(),
      tagline: inputs.p_tag.value.trim(),
      vars,
      links: {
        site: inputs.l_site.value.trim(),
        x: inputs.l_x.value.trim(),
        tg: inputs.l_tg.value.trim(),
        ds: inputs.l_ds.value.trim(),
        wp: inputs.l_wp.value.trim()
      },
      aboutEnabled: inputs.s_about_e.checked,
      about: inputs.s_about.value,
      tokenEnabled: inputs.s_token_e.checked,
      supply: inputs.tok_supply.value, dec: inputs.tok_dec.value,
      buy: inputs.tok_buy.value, sell: inputs.tok_sell.value,
      tokAlloc: inputs.tok_alloc.value,
      roadEnabled: inputs.s_road_e.checked, road: inputs.s_road.value,
      teamEnabled: inputs.s_team_e.checked, team: inputs.s_team.value,
      disclaimerEnabled: inputs.s_disclaimer_e.checked, disclaimer: inputs.s_disclaimer.value,
      logoSrc: state.logoUrl, bannerSrc: state.bannerUrl
    };
  }

  function buildPreview(){ preview.innerHTML = siteHtml(collect()); }

  // ORDER UI
  const orderList = document.getElementById('orderList');
  const SECTION_LABELS = {about:'About', token:'Tokenomics', road:'Roadmap', team:'Team'};
  function renderOrderUI(){
    orderList.innerHTML = '';
    state.order.forEach((key, idx)=>{
      const row = document.createElement('div');
      row.className = 'card section';
      row.style.padding = '10px';
      row.innerHTML = `
        <div class="flex" style="justify-content:space-between">
          <div class="flex" style="gap:8px">
            <span class="badge">${idx+1}</span>
            <strong>${SECTION_LABELS[key]}</strong>
          </div>
          <div class="flex">
            <button class="btn" data-act="up" data-key="${key}">↑</button>
            <button class="btn" data-act="down" data-key="${key}">↓</button>
          </div>
        </div>`;
      orderList.appendChild(row);
    });
  }
  orderList.addEventListener('click', (e)=>{
    const btn = e.target.closest('button[data-act]');
    if(!btn) return;
    const key = btn.dataset.key, act = btn.dataset.act;
    const i = state.order.indexOf(key);
    if(i<0) return;
    if(act==='up' && i>0){ [state.order[i-1], state.order[i]] = [state.order[i], state.order[i-1]]; }
    if(act==='down' && i<state.order.length-1){ [state.order[i+1], state.order[i]] = [state.order[i], state.order[i+1]]; }
    renderOrderUI(); buildPreview();
  });
  renderOrderUI();

  // live update
  Object.values(inputs).forEach(i=>{
    i.addEventListener('input', buildPreview);
    i.addEventListener('change', buildPreview);
  });
  buildPreview();

  // export
  exportBtn.addEventListener('click', async ()=>{
    const data = collect();
    const zip = new JSZip();
    const assets = zip.folder('assets');
    let logoName='', bannerName='';
    if(state.logo){ logoName = 'logo' + ext(state.logo.name); assets.file(logoName, state.logo); }
    if(state.banner){ bannerName = 'banner' + ext(state.banner.name); assets.file(bannerName, state.banner); }

    const html = siteHtml({...data, logoSrc: logoName ? 'assets/'+logoName : '', bannerSrc: bannerName ? 'assets/'+bannerName : ''});
    zip.file('index.html', html);

    const content = await zip.generateAsync({type:'blob'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(content);
    a.download = (data.ticker||'site')+'_site.zip';
    a.click();
  });
  const ext = n => (n.toLowerCase().match(/\.[a-z0-9]+$/)||['.png'])[0];

  refreshBtn.addEventListener('click', buildPreview);
})();
</script>
</body>
</html>
